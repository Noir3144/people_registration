<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title data-i18n="title_register">Registration</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="ios-bg">
  <header class="topbar">
    <div class="brand">Crowd Portal</div>
    <nav>
      <a href="{{ url_for('language') }}" class="link">Language</a>
      <a href="#" id="notif-btn" class="link">Notifications</a>
      <a href="{{ url_for('report_missing_page') }}" class="link">Report Missing</a>
    </nav>
  </header>

  <main class="container">
    <section class="card">
      <h2 data-i18n="registration_form">Registration</h2>
      <form id="reg-form" method="POST" action="{{ url_for('register') }}" enctype="multipart/form-data">
        <div class="field">
          <label data-i18n="mobile_no">Mobile No (required)</label>
          <input type="text" name="phone" required placeholder="+91xxxxxxxxxx">
        </div>

        <div class="field">
          <label data-i18n="whatsapp_no">WhatsApp No (required)</label>
          <input type="text" name="whatsapp" required placeholder="+91xxxxxxxxxx">
        </div>

        <div class="field">
          <label data-i18n="secondary_no">Secondary Contact No (optional)</label>
          <input type="text" name="secondary" placeholder="+91xxxxxxxxxx">
        </div>

        <div class="field">
          <label data-i18n="photos">Family Photos (use camera)</label>
          <div id="camera-slots" class="slots"></div>
          <!-- hidden input that will be filled with captured blobs via JS before submit -->
          <input type="file" name="family_photos" id="hidden-photo-input" accept="image/*" style="display:none" multiple>
          <div class="muted small" data-i18n="camera_hint">Click the + slot to capture a photo using your device camera. New slots appear after capture.</div>
        </div>

        <div class="actions">
          <button class="btn" type="submit" id="submit-reg" data-i18n="submit">Submit</button>
        </div>
      </form>
    </section>
  </main>

  <!-- Notifications modal -->
  <div id="notif-modal" class="modal hidden">
    <div class="modal-card">
      <header class="modal-header">
        <h3>Notifications</h3>
        <button class="close" id="close-notif">&times;</button>
      </header>
      <div class="modal-body" id="notif-list">
        <!-- loaded via fetch /notifications -->
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='script.js') }}"></script>
  <script>
    // init camera slots for registration
    window.addEventListener('DOMContentLoaded', () => {
      RegForm.initCameraSlots();
      Notif.init();
    });
  </script>
</body>
</html>
