{% extends "base.html" %}
{% block content %}
<section class="card glass">
  <h2 data-i18n="board.title">Notification Board</h2>
  <p class="muted" data-i18n="board.subtitle">Recently reported missing/found items.</p>

  <div id="board" class="board"></div>
</section>

<script>
  (async function(){
    try {
      const res = await fetch("{{ url_for('notifications') }}");
      const data = await res.json();
      const el = document.getElementById('board');
      el.innerHTML = "";
      if (!data.length) {
        el.innerHTML = `<div class="empty" data-i18n="board.empty">No notifications yet.</div>`;
        window.applyI18n && window.applyI18n();
        return;
      }
      for (const item of data) {
        const card = document.createElement('div');
        card.className = 'note glass';
        card.innerHTML = `
          <div class="note-row">
            <div class="note-status" data-i18n="board.reported">Reported</div>
            <div class="note-time">${item.timestamp || ''}</div>
          </div>
          <div class="note-row">
            <div class="note-phone">ðŸ“ž ${item.phone || ''}</div>
          </div>
          <div class="note-row">
            <div class="note-desc">${(item.description || '').toString().slice(0,140)}</div>
          </div>
        `;
        el.appendChild(card);
      }
      window.applyI18n && window.applyI18n();
    } catch(e){
      console.error(e);
    }
  })();
</script>
{% endblock %}
